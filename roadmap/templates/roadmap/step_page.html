{% extends "roadmap/base.html" %}

{% load wagtailcore_tags %}
{% load wagtailimages_tags %}

{% block left-content %}

    <div class="row">
        {% if page.next_step %}
            <a href="{{ page.get_parent.url }}">
                <i class="fa fa-arrow-right" aria-hidden="true"></i>
                Next Step
            </a>
        {% endif %}
    </div>

    <div class="row">
        <h1>{{ page.title }}</h1>
    </div>

    <div class="row">
        {{ page.body|richtext }}
    </div>

    {% if page.address %}
        <div class="row"><h3>Location</h3></div>
        <div class="row">
            <div id="map" data-lat="{{page.lat}}" data-lng="{{page.lng}}" data-address="{{page.address}}" style="width:500px;height:500px;"></div>
        </div>

        <script>
          function initMap() {
            var mapDiv = document.getElementById('map');

            var myLatLng = {lat: Number(mapDiv.dataset.lat), lng: Number(mapDiv.dataset.lng)};

            var map = new google.maps.Map(mapDiv, {
              zoom: 13,
              center: myLatLng
            });

            var contentString = '<div id="content">'+
                '<h3 id="firstHeading" class="firstHeading">Location</h3>'+
                '<div id="bodyContent"> <a href="http://maps.google.com/?q='+mapDiv.dataset.address+'">Go here</a>'
                '</div>'+
                '</div>';

            var infowindow = new google.maps.InfoWindow({
              content: contentString
            });


            var marker = new google.maps.Marker({
              position: myLatLng,
              map: map,
              title: 'Hello World!'
            });

            marker.addListener('click', function() {
              infowindow.open(map, marker);
            });
          }
        </script>
        <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD-_hKQV1UOV4Wsqj8D3SjDUg417An4w4I&callback=initMap"></script>
    {% endif %}
{% endblock %}

{% block extra-right-content %}
    <div class="print-page">
        <a href="javascript:window.print()">
            <i class="fa fa-print" aria-hidden="true"></i>
            Print Page
        </a>
    </div>
{% endblock %}